<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏õ‡∏è‡∏¥‡∏ç‡∏≤‡∏ì</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Srisakdi:wght@700&display=swap"
      rel="stylesheet"
    />
    <script
      charset="utf-8"
      src="https://static.line-scdn.net/liff/edge/2/sdk.js"
    ></script>
    <style>
      body {
        font-family: "Srisakdi", sans-serif;
        background: url("https://res.cloudinary.com/gukkghu/image/upload/v1752866998/%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B2%E0%B8%82%E0%B8%AD%E0%B8%87_7_-_%E0%B9%80%E0%B8%89%E0%B8%A5%E0%B8%B4%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B8%8A%E0%B8%99%E0%B8%A1%E0%B8%9E%E0%B8%A3%E0%B8%A3%E0%B8%A9%E0%B8%B2_6_%E0%B8%A3%E0%B8%AD%E0%B8%9A_%E0%B8%A310_komxqy.png")
          no-repeat center center fixed;
        background-size: cover;
      }

      @media screen and (max-width: 768px) {
        body {
          background-image: url("https://res.cloudinary.com/gukkghu/image/upload/v1752866945/%E0%B8%97%E0%B8%A3%E0%B8%87%E0%B8%9E%E0%B8%A3%E0%B8%B0%E0%B9%80%E0%B8%88%E0%B8%A3%E0%B8%B4%E0%B8%8D_2_ounl2d.png");
        }
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      }
      .signature-pad {
        border: 2px dashed #d97706;
        background-color: #fff;
        border-radius: 0.5rem;
      }
      .fade-in {
        animation: fadeIn 0.3s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      .popup {
        animation: popupSlide 0.5s ease-out;
      }
      .oath-text {
        font-family: "Srisakdi", cursive;
        color: #d4af37; /* ‡∏™‡∏µ‡∏ó‡∏≠‡∏á */
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        font-size: 0.95rem;
        line-height: 1.8;
      }

      @keyframes popupSlide {
        0% {
          opacity: 0;
          transform: translateY(-50px) scale(0.8);
        }
        100% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
    </style>
  </head>
  <body class="min-h-screen flex justify-end items-center p-6">
    <!-- Main Form Card -->
    <div
      id="formWrapper"
      class="hidden fixed inset-0 z-40 sm:inset-auto sm:right-4 sm:bottom-4 w-full sm:max-w-lg flex items-center justify-center p-2 sm:p-0"
    >
      <div
        class="glass-card w-full max-w-lg rounded-xl p-4 sm:p-8 space-y-6 z-10 max-h-[90vh] overflow-y-auto"
      >
        <div class="flex justify-end">
          <button
            onclick="toggleForm()"
            class="text-gray-600 hover:text-red-500 text-xl font-bold"
          >
            ‚úñ
          </button>
        </div>

        <div class="text-center">
          <div class="flex justify-center">
            <img
              src="https://lh3.googleusercontent.com/oaOqspJphwope337GN4qOVXuhCdbGGs_yakmPfkTCWXp4Xc_PXYlld5Llb0vIBqfj6SI5X8ZpxjrL1YvVfQ-_NPmz_otnzfOIMMY0M6QMaMGTqSDCAGq4QY1JA=w16383"
              width="70px"
              alt=""
            />
          </div>
          <h1 class="text-lg font-bold text-amber-700">
            ‡∏Ç‡∏≠‡πÄ‡∏ä‡∏¥‡∏ç‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏π ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
          </h1>
          <p class="text-md text-amber-600">
            ‡∏£‡πà‡∏ß‡∏°‡∏•‡∏á‡∏ô‡∏≤‡∏°‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏õ‡∏è‡∏¥‡∏ç‡∏≤‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞<br />

            ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô
          </p>
        </div>

        <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå -->
        <div class="bg-white bg-opacity-70 rounded-xl p-1 text-center">
          <div class="oath-text leading-relaxed">
            ‡∏Ç‡πâ‡∏≤‡∏û‡∏£‡∏∞‡∏û‡∏∏‡∏ó‡∏ò‡πÄ‡∏à‡πâ‡∏≤ ‡∏Ç‡∏≠‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏õ‡∏è‡∏¥‡∏ç‡∏≤‡∏ì‡∏ß‡πà‡∏≤
            ‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô
            ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏™‡∏∏‡∏à‡∏£‡∏¥‡∏ï ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏£‡∏≠‡∏¢‡∏ï‡∏≤‡∏°‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏û‡∏£‡∏∞‡∏¢‡∏∏‡∏Ñ‡∏•‡∏ö‡∏≤‡∏ó
            ‡∏°‡∏∏‡πà‡∏á‡∏°‡∏±‡πà‡∏ô‡πÅ‡∏ô‡πà‡∏ß‡πÅ‡∏ô‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ä‡∏≤‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô
            ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÅ‡∏Å‡πà‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô
            ‡πÅ‡∏•‡∏∞‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÇ‡∏î‡∏¢‡∏¢‡∏∂‡∏î‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ò‡∏£‡∏£‡∏°‡∏Ñ‡∏≥‡∏™‡∏≠‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏®‡∏≤‡∏™‡∏ô‡∏≤
            ‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏û‡∏£‡∏∞‡∏ö‡∏£‡∏°‡∏£‡∏≤‡πÇ‡∏ä‡∏ß‡∏≤‡∏ó‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ
          </div>
        </div>

        <form id="loyaltyForm" class="space-y-1">
          <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
          <div>
            <label class="block text-sm font-semibold text-amber-800 mb-1"
              >‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ *</label
            >
            <select
              name="status"
              required
              class="w-full p-2.5 rounded border border-amber-300 bg-white focus:outline-amber-500 text-sm"
            >
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
              <option value="‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô">‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</option>
              <option value="‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£" selected>‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option>
            </select>
          </div>

          <!-- ‡∏ä‡∏∑‡πà‡∏≠ -->
          <div>
            <label class="block text-sm font-semibold text-amber-800 mb-1"
              >‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label
            >
            <input
              name="fullName"
              type="text"
              required
              placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"
              class="w-full p-2.5 rounded border border-amber-300 bg-white focus:outline-amber-500 text-sm"
            />
          </div>

          <!-- ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô -->
          <div id="agencyField" class="hidden fade-in">
            <label class="block text-sm font-semibold text-amber-800 mb-1"
              >‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô *</label
            >
            <input
              name="agency"
              type="text"
              placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"
              class="w-full p-2.5 rounded border border-amber-300 bg-white focus:outline-amber-500 text-sm"
              value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ß‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏á‡∏≤‡∏°"
            />
          </div>

          <!-- ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
          <div id="positionField" class="hidden fade-in">
            <label class="block text-sm font-semibold text-amber-800 mb-1"
              >‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á *</label
            >
            <input
              name="position"
              type="text"
              placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á"
              class="w-full p-2.5 rounded border border-amber-300 bg-white focus:outline-amber-500 text-sm"
            />
          </div>

          <!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -->
          <div>
            <label class="block text-sm font-semibold text-amber-800 mb-1"
              >‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô *</label
            >
            <canvas
              id="signaturePad"
              class="signature-pad w-full h-36"
            ></canvas>
            <div class="flex justify-between items-center mt-2">
              <button
                type="button"
                id="clearSignature"
                class="text-sm text-white bg-gray-500 px-3 py-1 rounded hover:bg-gray-600"
              >
                ‡∏•‡πâ‡∏≤‡∏á‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
              </button>
              <span class="text-xs text-gray-600">‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</span>
            </div>
          </div>

          <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á -->
          <button
            type="submit"
            id="submitBtn"
            class="w-full bg-gradient-to-r from-amber-500 to-yellow-500 text-white font-bold py-3 rounded-lg hover:from-amber-600 hover:to-yellow-600 transition-all"
          >
            <span id="submitText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
            <span id="loadingText" class="hidden">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...</span>
          </button>
        </form>
      </div>
    </div>
    <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏° -->
    <button
      id="openFormBtn"
      onclick="toggleForm()"
      class="fixed right-4 bottom-4 z-50 bg-gradient-to-r from-yellow-400 to-amber-500 text-white font-bold py-2 px-4 sm:py-6 sm:px-10 rounded-full shadow-lg hover:scale-105 transition-all text-sm sm:text-2xl md:text-xl"
    >
      ‚úçÔ∏è ‡∏£‡πà‡∏ß‡∏°‡∏•‡∏á‡∏ô‡∏≤‡∏°
    </button>

    <!-- Popup -->
    <div
      id="successPopup"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
    >
      <div class="bg-white rounded-xl p-6 text-center popup max-w-sm">
        <div class="text-4xl mb-3">üéâ</div>
        <h2 class="text-lg font-bold text-amber-700">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏•‡∏á‡∏ô‡∏≤‡∏°!</h2>
        <p class="text-sm text-amber-600 mb-4">
          ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
        </p>
        <button
          onclick="closePopup()"
          class="bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded"
        >
          ‡∏õ‡∏¥‡∏î
        </button>
      </div>
    </div>

    <!-- Script -->
    <script>
      const canvas = document.getElementById("signaturePad");
      const signaturePad = new SignaturePad(canvas, {
        backgroundColor: "rgb(255,255,255)",
        penColor: "#d4af37", // ‡∏™‡∏µ‡∏ó‡∏≠‡∏á
      });

      function resizeCanvas() {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;

        canvas.getContext("2d").scale(ratio, ratio);
        signaturePad.clear();
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      document
        .getElementById("clearSignature")
        .addEventListener("click", () => signaturePad.clear());

      document
        .querySelector('[name="status"]')
        .addEventListener("change", function () {
          const isGov = this.value === "‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£";
          document
            .getElementById("agencyField")
            .classList.toggle("hidden", !isGov);
          document
            .getElementById("positionField")
            .classList.toggle("hidden", !isGov);
          document.querySelector('[name="agency"]').required = isGov;
          document.querySelector('[name="position"]').required = isGov;
        });

      document
        .getElementById("loyaltyForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          if (signaturePad.isEmpty())
            return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ã‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");

          const submitBtn = document.getElementById("submitBtn");
          const submitText = document.getElementById("submitText");
          const loadingText = document.getElementById("loadingText");

          submitBtn.disabled = true;
          submitText.classList.add("hidden");
          loadingText.classList.remove("hidden");

          try {
            const formData = new FormData(this);
            const data = {
              status: formData.get("status"),
              fullName: formData.get("fullName"),
              agency: formData.get("agency") || "",
              position: formData.get("position") || "",
              signature: signaturePad.toDataURL(),
              timestamp: new Date().toLocaleString("th-TH"),
            };

            const response = await fetch(
              "https://script.google.com/macros/s/AKfycbzp0eG_wEm1QWRvhK7pFEnHrKN0F7GAuRuS6pBnT_t2KJQf9YWvu1s0ePSicXnHGT9i/exec",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/x-www-form-urlencoded",
                },
                body: new URLSearchParams(data),
              }
            );

            if (!response.ok) throw new Error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");

            showSuccessPopup();
            sendFlexToLINE(fullName, signature);
            this.reset();
            signaturePad.clear();
          } catch (err) {
            console.error(err);
            alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà");
          } finally {
            submitBtn.disabled = false;
            submitText.classList.remove("hidden");
            loadingText.classList.add("hidden");
          }
        });

      function showSuccessPopup() {
        document.getElementById("successPopup").classList.remove("hidden");
      }
      function closePopup() {
        document.getElementById("successPopup").classList.add("hidden");
      }
      function toggleForm() {
        const formWrapper = document.getElementById("formWrapper");
        const openFormBtn = document.getElementById("openFormBtn");

        const isHidden = formWrapper.classList.contains("hidden");

        formWrapper.classList.toggle("hidden");

        if (isHidden) {
          openFormBtn.classList.add("hidden");
          // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å resizeCanvas ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
          setTimeout(() => resizeCanvas(), 100); // ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏´‡πâ DOM ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
        } else {
          openFormBtn.classList.remove("hidden");
        }
      }

      window.addEventListener("DOMContentLoaded", async () => {
        await liff.init({ liffId: "1657704109-dZayMMoA" }); // <-- ‡πÉ‡∏™‡πà LIFF ID ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

        if (!liff.isLoggedIn()) {
          liff.login(); // ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
          return;
        }

        const status = document.querySelector('[name="status"]').value;
        const isGov = status === "‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£";

        document
          .getElementById("agencyField")
          .classList.toggle("hidden", !isGov);
        document
          .getElementById("positionField")
          .classList.toggle("hidden", !isGov);
        document.querySelector('[name="agency"]').required = isGov;
        document.querySelector('[name="position"]').required = isGov;

        resizeCanvas();
      });

      async function sendFlexToLINE(fullName, signature) {
        const flexMessage = {
          type: "flex",
          altText: "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏õ‡∏è‡∏¥‡∏ç‡∏≤‡∏ì",
          contents: {
            type: "bubble",
            size: "mega",
            hero: {
              type: "image",
              url: signature,
              size: "full",
              aspectRatio: "3:1",
              aspectMode: "fit",
            },
            body: {
              type: "box",
              layout: "vertical",
              spacing: "md",
              contents: [
                {
                  type: "text",
                  text: "üéâ ‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì",
                  weight: "bold",
                  size: "lg",
                  color: "#D4AF37",
                },
                {
                  type: "text",
                  text: fullName,
                  weight: "bold",
                  size: "xl",
                  color: "#111111",
                  wrap: true,
                },
                {
                  type: "text",
                  text: "‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏ñ‡∏ß‡∏≤‡∏¢‡∏™‡∏±‡∏ï‡∏¢‡πå‡∏õ‡∏è‡∏¥‡∏ç‡∏≤‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏û‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô",
                  size: "sm",
                  color: "#666666",
                  wrap: true,
                },
              ],
            },
            footer: {
              type: "box",
              layout: "vertical",
              spacing: "sm",
              contents: [
                {
                  type: "button",
                  style: "primary",
                  color: "#FBBF24",
                  action: {
                    type: "uri",
                    label: "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",
                    uri: "https://moe.go.th/", // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏£‡∏¥‡∏á
                  },
                },
              ],
            },
            styles: {
              body: {
                backgroundColor: "#FFF8E1",
              },
              footer: {
                backgroundColor: "#FFFAF0",
              },
            },
          },
        };

        try {
          if (!liff.isInitialized()) {
            await liff.init({ liffId: "1657704109-dZayMMoA" }); // üü† ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢
          }
          await liff.shareTargetPicker([flexMessage]);
        } catch (err) {
          console.error("LINE Flex Message Error:", err);
          alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° LINE ‡πÑ‡∏î‡πâ: " + err.message);
        }
      }
    </script>
  </body>
</html>
