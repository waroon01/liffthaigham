<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ระบบออกเลขหนังสือราชการ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    html, body { font-family: 'Noto Sans Thai', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
    .required:after { content: ' *'; color: #ef4444; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 via-slate-100 to-slate-200">
  <!-- App Shell -->
  <header class="sticky top-0 z-10 backdrop-blur bg-white/70 border-b border-slate-200">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-2xl bg-slate-900 text-white grid place-items-center text-lg font-semibold shadow-sm">OA</div>
        <div>
          <h1 class="text-lg md:text-xl font-semibold text-slate-800">ระบบออกเลขหนังสือราชการ</h1>
          <p class="text-xs text-slate-500">เตรียมพร้อมสำหรับ LIFF — มีส่วนโปรไฟล์ไว้แล้ว</p>
        </div>
      </div>
      <!-- Profile (placeholder for future LIFF) -->
      <div id="profileBox" class="flex items-center gap-3">
        <img id="profileAvatar" src="https://api.dicebear.com/9.x/identicon/svg?seed=Guest" alt="avatar" class="w-10 h-10 rounded-full ring-2 ring-white shadow"/>
        <div class="leading-tight">
          <div id="profileName" class="text-sm font-medium text-slate-700">Guest</div>
          <div id="profileMeta" class="text-[11px] text-slate-500">ยังไม่เชื่อมต่อ LIFF</div>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8">
    <div class="grid md:grid-cols-3 gap-6">
      <!-- Form card -->
      <section class="md:col-span-3">
        <form id="letterForm" class="bg-white rounded-2xl shadow p-6 border border-slate-200 space-y-5" novalidate>
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-semibold text-slate-800">ฟอร์มออกเลขหนังสือ</h2>
            <span class="text-xs px-2 py-1 rounded-full bg-slate-100 text-slate-600 border">v1.0</span>
          </div>

          <!-- Alerts -->
          <div id="alertBox" class="hidden"></div>

          <div class="grid sm:grid-cols-2 gap-4">
            <!-- documentType -->
            <div>
              <label class="required block text-sm font-medium text-slate-700">ประเภทเอกสาร</label>
              <select id="documentType" name="documentType" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500">
                <option value="">— เลือกประเภท —</option>
                <option value="OUTLETTER">OUTLETTER (หนังสือออก)</option>
                <option value="NOTE">NOTE (บันทึกข้อความ)</option>
                <option value="ORDER">ORDER (คำสั่ง)</option>
                <option value="CERTIFICATE">CERTIFICATE (ใบรับรอง)</option>
              </select>
              <p class="mt-1 text-xs text-rose-600 min-h-5" data-error-for="documentType"></p>
            </div>
            <!-- year -->
            <div>
              <label class="required block text-sm font-medium text-slate-700">ปี (พ.ศ.)</label>
              <input id="year" name="year" type="number" inputmode="numeric" min="2568" readonly value="2568" placeholder="เช่น 2568" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500" />
              <p class="mt-1 text-xs text-rose-600 min-h-5" data-error-for="year"></p>
            </div>
          </div>

          <!-- title -->
          <div>
            <label class="block required text-sm font-medium text-slate-700">เรื่อง</label>
            <textarea id="title" name="title" rows="3" maxlength="500" placeholder="พิมพ์เรื่อง (อย่างน้อย 5 ตัวอักษร ไม่เกิน 500)" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                   focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 resize-none"></textarea>
            <div class="flex justify-between items-center mt-1">
              <p class="text-xs text-rose-600 min-h-5" data-error-for="title"></p>
              <p class="text-xs text-slate-500"><span id="titleCount">0</span>/500</p>
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <!-- issuedBy -->
            <div>
              <label class="block required text-sm font-medium text-slate-700">ผู้ออกเลขที่</label>
              <input id="issuedBy" name="issuedBy" type="text" maxlength="255" placeholder="ชื่อผู้ออกเลขที่" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500" />
              <p class="mt-1 text-xs text-rose-600 min-h-5" data-error-for="issuedBy"></p>
            </div>
            <!-- recipient -->
            <div>
              <label class="block required text-sm font-medium text-slate-700">ผู้รับเอกสาร</label>
              <input id="recipient" name="recipient" type="text" maxlength="255" placeholder="ชื่อผู้รับเอกสาร" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500" />
              <p class="mt-1 text-xs text-rose-600 min-h-5" data-error-for="recipient"></p>
            </div>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <!-- priority -->
            <div>
              <label class="block text-sm font-medium text-slate-700">ชั้นความเร็ว</label>
              <select id="priority" name="priority" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500">
                <option value="NORMAL">ปกติ (NORMAL)</option>
                <option value="URGENT">ด่วน (URGENT)</option>
                <option value="VERY_URGENT">ด่วนมาก (VERY_URGENT)</option>
                <option value="MOST_URGENT">ด่วนที่สุด (MOST_URGENT)</option>
              </select>
              <p class="mt-1 text-xs text-rose-600 min-h-5" data-error-for="priority"></p>
            </div>
            <!-- note -->
            <div>
              <label class="block text-sm font-medium text-slate-700">หมายเหตุ (ถ้ามี)</label>
              <textarea id="note" name="note" rows="2" maxlength="500" placeholder="บันทึกเพิ่มเติม (ไม่บังคับ)" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm text-slate-700
                     focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 resize-none"></textarea>
              <div class="flex justify-between items-center mt-1">
                <p class="text-xs text-rose-600 min-h-5" data-error-for="note"></p>
                <p class="text-xs text-slate-500"><span id="noteCount">0</span>/500</p>
              </div>
            </div>
          </div>

          <div class="flex items-center gap-3 pt-2">
            <button id="submitBtn" type="submit" class="inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-slate-900 text-white hover:bg-slate-800 active:scale-[.98] shadow-sm disabled:opacity-60 disabled:cursor-not-allowed">
              <svg id="submitSpinner" class="hidden animate-spin -ml-1 mr-1 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path></svg>
              บันทึกข้อมูล
            </button>
            <button type="reset" class="px-4 py-2.5 rounded-xl border border-slate-300 text-slate-700 hover:bg-slate-50">ล้างฟอร์ม</button>
          </div>
        </form>
      </section>
    </div>
  </main>

  <footer class="max-w-5xl mx-auto px-4 py-10 text-center text-xs text-slate-500">
    © <span id="yearNow"></span> Official Letter Webapp • Tailwind + Vanilla JS
  </footer>

  <script src="/script.js"></script>
</body>
</html>
